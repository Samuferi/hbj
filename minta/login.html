<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hibabejelentő – Bejelentkezés / Regisztráció</title>
  <style>
    :root{
      --bg: #0b1020;
      --card: #10162a;
      --muted: #8b93a7;
      --text: #ecf0ff;
      --primary: #5b8cff;
      --primary-600: #4a78e6;
      --danger: #ef4444;
      --ring: rgba(91,140,255,.45);
      --success: #22c55e;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin: 0; font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1000px 600px at 10% -10%, #1a2150 0%, transparent 60%),
                  radial-gradient(900px 500px at 110% 10%, #16213e 0%, transparent 60%),
                  var(--bg);
      display: grid; place-items: center; padding: 24px;
    }
    .card{
      width: 100%; max-width: 440px; background: var(--card); border-radius: var(--radius);
      box-shadow: var(--shadow); border: 1px solid rgba(255,255,255,.06);
    }
    .card header{ padding: 22px 24px 0; text-align: center; }
    h1{ font-size: 22px; margin: 0 0 6px; }
    .sub{ color: var(--muted); font-size: 13px; margin: 0 0 14px; }

    .tabs{ display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 0 16px; }
    .tab-btn{
      border: 1px solid rgba(255,255,255,.08); background: #0f1427; color: var(--text);
      border-radius: 999px; padding: 10px 12px; cursor: pointer; transition: .2s ease;
    }
    .tab-btn[aria-selected="true"]{ background: var(--primary); border-color: var(--primary); }

    form{ padding: 18px 20px 22px; display: grid; gap: 14px; }
    .field{ display: grid; gap: 6px; }
    label{ font-size: 14px; color: #c9d3ff; }

    .control{ position: relative; }
    .input{
      width: 100%; background: #0b1022; color: var(--text); border: 1px solid rgba(255,255,255,.08);
      border-radius: 12px; padding: 12px 12px; outline: none; transition: border .15s, box-shadow .15s;
    }
    .input:focus{ border-color: var(--primary); box-shadow: 0 0 0 4px var(--ring); }
    .with-leftpad{ padding-left: 38px; }
    .icon{ position: absolute; left: 10px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; opacity: .7; }

    .toggle-eye{ position: absolute; right: 8px; top: 50%; transform: translateY(-50%); border: 0; background: transparent; cursor: pointer; padding: 6px; border-radius: 10px; }
    .toggle-eye:hover{ background: rgba(255,255,255,.06); }

    .error{ color: var(--danger); font-size: 12px; min-height: 16px; }
    .alert{ display: none; padding: 10px 12px; border-radius: 12px; font-size: 14px; }
    .alert.error{ background: rgba(239,68,68,.12); border: 1px solid rgba(239,68,68,.45); color: #fecaca; }
    .alert.success{ background: rgba(34,197,94,.14); border: 1px solid rgba(34,197,94,.5); color: #bbf7d0; }
    .alert.show{ display: block; }

    .btn{
      appearance: none; border: 0; cursor: pointer; width: 100%; border-radius: 12px; padding: 12px 14px;
      background: var(--primary); color: white; font-weight: 600; letter-spacing: .2px; box-shadow: 0 6px 16px rgba(91,140,255,.35);
      transition: transform .06s ease, background .2s ease; display: inline-flex; align-items: center; justify-content: center; gap: 8px;
    }
    .btn:active{ transform: translateY(1px); }
    .btn[disabled]{ opacity: .6; cursor: not-allowed; }

    .fineprint{ color: var(--muted); font-size: 12px; text-align: center; padding: 0 20px 18px; }

    .hidden{ display: none !important; }
  </style>
</head>
<body>
  <section class="card" role="application">
    <header>
      <h1>Hibabejelentő – Belépés / Regisztráció</h1>
      <p class="sub">Lépj be, vagy hozz létre fiókot a hibajegyek kezeléséhez</p>
    </header>

    <nav class="tabs" role="tablist" aria-label="Nézet váltása">
      <button id="tab-login" class="tab-btn" role="tab" aria-selected="true" aria-controls="panel-login">Bejelentkezés</button>
      <button id="tab-register" class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-register">Regisztráció</button>
    </nav>

    <!-- Bejelentkezés -->
    <div id="panel-login" role="tabpanel" aria-labelledby="tab-login">
      <form id="form-login" novalidate>
        <div id="login-alert" class="alert error" role="alert" aria-live="polite"></div>

        <div class="field">
          <label for="login-email">E‑mail</label>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 4h16v16H4z" stroke-width="1.5" opacity=".2"/><path d="M4 8l8 6 8-6" stroke-width="1.5"/></svg>
            <input id="login-email" name="email" type="email" class="input with-leftpad" placeholder="pelda@domain.hu" autocomplete="email" required />
          </div>
          <p class="error" id="login-email-error"></p>
        </div>

        <div class="field">
          <label for="login-password">Jelszó</label>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="8" stroke-width="1.5" opacity=".2"/><path d="M8 12h8" stroke-width="1.5"/></svg>
            <input id="login-password" name="password" type="password" class="input with-leftpad" placeholder="••••••••" autocomplete="current-password" required />
            <button type="button" class="toggle-eye" data-toggle="login-password" aria-label="Jelszó megjelenítése">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
          <p class="error" id="login-password-error"></p>
        </div>

        <button class="btn" id="login-submit" type="submit">
          <span>Bejelentkezés</span>
        </button>
      </form>
    </div>

    <!-- Regisztráció -->
    <div id="panel-register" role="tabpanel" aria-labelledby="tab-register" class="hidden">
      <form id="form-register" novalidate>
        <div id="register-alert" class="alert error" role="alert" aria-live="polite"></div>

        <div class="field">
          <label for="reg-name">Név</label>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="8" r="4"/><path d="M4 20c1.5-4 14.5-4 16 0"/></svg>
            <input id="reg-name" name="name" type="text" class="input with-leftpad" placeholder="Vezetéknév Keresztnév" autocomplete="name" required minlength="2" />
          </div>
          <p class="error" id="reg-name-error"></p>
        </div>

        <div class="field">
          <label for="reg-email">E‑mail</label>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 4h16v16H4z" stroke-width="1.5" opacity=".2"/><path d="M4 8l8 6 8-6" stroke-width="1.5"/></svg>
            <input id="reg-email" name="email" type="email" class="input with-leftpad" placeholder="pelda@domain.hu" autocomplete="email" required />
          </div>
          <p class="error" id="reg-email-error"></p>
        </div>

        <div class="field">
          <label for="reg-password">Jelszó</label>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="6" y="10" width="12" height="8" rx="2"/><path d="M8 10V8a4 4 0 0 1 8 0v2"/></svg>
            <input id="reg-password" name="password" type="password" class="input with-leftpad" placeholder="Legalább 8 karakter" autocomplete="new-password" required minlength="8" pattern="(?=.*[A-Za-z])(?=.*\d).+" />
            <button type="button" class="toggle-eye" data-toggle="reg-password" aria-label="Jelszó megjelenítése">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
          <p class="error" id="reg-password-error"></p>
        </div>

        <div class="field">
          <label for="reg-confirm">Jelszó megerősítése</label>
          <div class="control">
            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="6" y="10" width="12" height="8" rx="2"/><path d="M8 10V8a4 4 0 0 1 8 0v2"/></svg>
            <input id="reg-confirm" name="confirm" type="password" class="input with-leftpad" placeholder="Írd be újra a jelszót" autocomplete="new-password" required />
            <button type="button" class="toggle-eye" data-toggle="reg-confirm" aria-label="Jelszó megjelenítése">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
          <p class="error" id="reg-confirm-error"></p>
        </div>

        <button class="btn" id="register-submit" type="submit">
          <span>Regisztráció</span>
        </button>
      </form>
    </div>

    <p class="fineprint">A folytatással elfogadod a Felhasználási feltételeket és az Adatkezelési tájékoztatót.</p>
  </section>

  <script>
    // \u2014\u2014 Tab kezelés
    const tabLogin = document.getElementById('tab-login');
    const tabRegister = document.getElementById('tab-register');
    const panelLogin = document.getElementById('panel-login');
    const panelRegister = document.getElementById('panel-register');

    function activate(tab){
      const loginActive = tab === 'login';
      tabLogin.setAttribute('aria-selected', loginActive);
      tabRegister.setAttribute('aria-selected', !loginActive);
      panelLogin.classList.toggle('hidden', !loginActive);
      panelRegister.classList.toggle('hidden', loginActive);
    }
    tabLogin.addEventListener('click', ()=>activate('login'));
    tabRegister.addEventListener('click', ()=>activate('register'));

    // \u2014\u2014 Jelszó megjelenítés/elrejtés
    document.querySelectorAll('.toggle-eye').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const id = btn.getAttribute('data-toggle');
        const input = document.getElementById(id);
        const visible = input.getAttribute('type') === 'text';
        input.setAttribute('type', visible ? 'password' : 'text');
        btn.setAttribute('aria-label', visible ? 'Jelszó megjelenítése' : 'Jelszó elrejtése');
      });
    });

    // Segédek
    function setFieldError(id, msg){
      const el = document.getElementById(id);
      if(el){ el.textContent = msg || ''; }
    }
    function showAlert(id, msg, type='error'){
      const box = document.getElementById(id);
      if(!box) return;
      box.className = `alert ${type} ${msg ? 'show' : ''}`;
      box.textContent = msg || '';
    }

    // Mockolt API hívások \u2013 itt cseréld le fetch-re a saját backendhez
    async function apiLogin(payload){
      await new Promise(r=>setTimeout(r, 500));
      if(payload.email === 'error@example.com'){
        const err = new Error('Hibás belépési adatok');
        err.field = 'email';
        throw err;
      }
      return { token: 'fake-jwt', user: { name: 'Teszt Elek', email: payload.email } };
    }
    async function apiRegister(payload){
      await new Promise(r=>setTimeout(r, 600));
      if(/@invalid$/.test(payload.email)){
        const err = new Error('Ezzel az e-mail címmel már regisztráltak');
        err.field = 'reg-email-error';
        throw err;
      }
      return { id: 'user_123', ...payload };
    }

    // Bejelentkezés submit
    const formLogin = document.getElementById('form-login');
    formLogin.addEventListener('submit', async (e)=>{
      e.preventDefault();
      showAlert('login-alert', '');
      setFieldError('login-email-error', '');
      setFieldError('login-password-error', '');

      const email = document.getElementById('login-email');
      const password = document.getElementById('login-password');

      // HTML5 validáció
      if(!email.checkValidity()){
        setFieldError('login-email-error', email.validationMessage);
        email.focus();
        return;
      }
      if(!password.checkValidity()){
        setFieldError('login-password-error', password.validationMessage || 'A jelszó kötelező');
        password.focus();
        return;
      }

      const submitBtn = document.getElementById('login-submit');
      submitBtn.disabled = true; submitBtn.innerHTML = '<span>Bejelentkezés...</span>';
      try{
        const res = await apiLogin({ email: email.value.trim(), password: password.value });
        showAlert('login-alert', 'Sikeres bejelentkezés! Átirányítás...', 'success');
        // TODO: token kezelése (httpOnly cookie ajánlott), redirect a dashboardra
      }catch(err){
        if(err.field === 'email') setFieldError('login-email-error', err.message);
        else if(err.field === 'password') setFieldError('login-password-error', err.message);
        else showAlert('login-alert', err.message || 'Ismeretlen hiba történt');
      }finally{
        submitBtn.disabled = false; submitBtn.innerHTML = '<span>Bejelentkezés</span>';
      }
    });

    // Regisztráció submit
    const formRegister = document.getElementById('form-register');
    formRegister.addEventListener('submit', async (e)=>{
      e.preventDefault();
      showAlert('register-alert', '');
      setFieldError('reg-name-error', '');
      setFieldError('reg-email-error', '');
      setFieldError('reg-password-error', '');
      setFieldError('reg-confirm-error', '');

      const name = document.getElementById('reg-name');
      const email = document.getElementById('reg-email');
      const pass = document.getElementById('reg-password');
      const confirm = document.getElementById('reg-confirm');

      if(!name.checkValidity()){
        setFieldError('reg-name-error', name.validationMessage);
        name.focus(); return;
      }
      if(!email.checkValidity()){
        setFieldError('reg-email-error', email.validationMessage);
        email.focus(); return;
      }
      if(!pass.checkValidity()){
        setFieldError('reg-password-error', pass.validity.patternMismatch ? 'Kell legalább 1 betű és 1 szám' : pass.validationMessage);
        pass.focus(); return;
      }
      if(confirm.value !== pass.value){
        setFieldError('reg-confirm-error', 'A jelszavak nem egyeznek');
        confirm.focus(); return;
      }

      const btn = document.getElementById('register-submit');
      btn.disabled = true; btn.innerHTML = '<span>Regisztráció...</span>';
      try{
        const res = await apiRegister({ name: name.value.trim(), email: email.value.trim(), password: pass.value });
        showAlert('register-alert', 'Sikeres regisztráció! Most jelentkezz be.', 'success');
        // Siker után átváltunk a bejelentkezés fülre
        activate('login');
      }catch(err){
        if(err.field) setFieldError(err.field, err.message);
        else showAlert('register-alert', err.message || 'Ismeretlen hiba történt');
      }finally{
        btn.disabled = false; btn.innerHTML = '<span>Regisztráció</span>';
      }
    });
  </script>
</body>
</html>